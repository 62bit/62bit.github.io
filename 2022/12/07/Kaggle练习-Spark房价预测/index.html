<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>Kaggle练习:Spark房价预测 | 62bit的秘密基地</title><meta name="author" content="62bit"><meta name="copyright" content="62bit"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="写在前面数据集：House Prices - Advanced Regression Techniques | Kaggle 参考：零基础入门 Spark (geekbang.org) 具体实现特征工程1. 读取数据123456789val rootPath: String &#x3D; _val filePath: String &#x3D; s&quot;$rootPath&#x2F;train.csv&quot;&#x2F;&#x2F; 读">
<meta property="og:type" content="article">
<meta property="og:title" content="Kaggle练习:Spark房价预测">
<meta property="og:url" content="http://example.com/2022/12/07/Kaggle%E7%BB%83%E4%B9%A0-Spark%E6%88%BF%E4%BB%B7%E9%A2%84%E6%B5%8B/index.html">
<meta property="og:site_name" content="62bit的秘密基地">
<meta property="og:description" content="写在前面数据集：House Prices - Advanced Regression Techniques | Kaggle 参考：零基础入门 Spark (geekbang.org) 具体实现特征工程1. 读取数据123456789val rootPath: String &#x3D; _val filePath: String &#x3D; s&quot;$rootPath&#x2F;train.csv&quot;&#x2F;&#x2F; 读">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/favicon.png">
<meta property="article:published_time" content="2022-12-07T05:50:13.000Z">
<meta property="article:modified_time" content="2023-03-17T05:27:19.379Z">
<meta property="article:author" content="62bit">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/favicon.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2022/12/07/Kaggle%E7%BB%83%E4%B9%A0-Spark%E6%88%BF%E4%BB%B7%E9%A2%84%E6%B5%8B/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: 62bit","link":"链接: ","source":"来源: 62bit的秘密基地","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Kaggle练习:Spark房价预测',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-03-17 13:27:19'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/favicon.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">31</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="62bit的秘密基地"><span class="site-name">62bit的秘密基地</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Kaggle练习:Spark房价预测</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-12-07T05:50:13.000Z" title="发表于 2022-12-07 13:50:13">2022-12-07</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-03-17T05:27:19.379Z" title="更新于 2023-03-17 13:27:19">2023-03-17</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Kaggle练习:Spark房价预测"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h1><p>数据集：<a target="_blank" rel="noopener" href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques/overview">House Prices - Advanced Regression Techniques | Kaggle</a></p>
<p>参考：<a target="_blank" rel="noopener" href="https://time.geekbang.org/column/intro/100090001?utm_term=iTab&utm_source=iTab&utm_medium=iTab&utm_campaign=iTab&utm_content=iTab&tab=catalog">零基础入门 Spark (geekbang.org)</a></p>
<h1 id="具体实现"><a href="#具体实现" class="headerlink" title="具体实现"></a>具体实现</h1><h2 id="特征工程"><a href="#特征工程" class="headerlink" title="特征工程"></a>特征工程</h2><h3 id="1-读取数据"><a href="#1-读取数据" class="headerlink" title="1. 读取数据"></a>1. 读取数据</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> rootPath: <span class="type">String</span> = _</span><br><span class="line"><span class="keyword">val</span> filePath: <span class="type">String</span> = <span class="string">s&quot;<span class="subst">$rootPath</span>/train.csv&quot;</span></span><br><span class="line"><span class="comment">// 读取文件，创建DataFrame</span></span><br><span class="line"><span class="keyword">val</span> spark = <span class="type">SparkSession</span></span><br><span class="line">  .builder()</span><br><span class="line">  .appName(<span class="string">&quot;sparkdf&quot;</span>)</span><br><span class="line">  .master(<span class="string">&quot;local[*]&quot;</span>)</span><br><span class="line">  .getOrCreate()</span><br><span class="line"><span class="keyword">var</span> df: <span class="type">DataFrame</span> = spark.read.format(<span class="string">&quot;csv&quot;</span>).option(<span class="string">&quot;header&quot;</span>, value = <span class="literal">true</span>).load(filePath)</span><br></pre></td></tr></table></figure>

<h3 id="2-数据分类"><a href="#2-数据分类" class="headerlink" title="2. 数据分类"></a>2. 数据分类</h3><p>​		为了提升数据的区分度，对部分字段采用离散化处理，所以要事先分配好需要离散化的字段</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//需要离散化的字段</span></span><br><span class="line"><span class="keyword">var</span> discreteFields =<span class="type">Array</span>(<span class="string">&quot;BedroomAbvGr&quot;</span>, <span class="string">&quot;OverallQual&quot;</span>, <span class="string">&quot;OverallCond&quot;</span>)</span><br><span class="line"><span class="comment">//数值型字段</span></span><br><span class="line"><span class="keyword">val</span> numericFields: <span class="type">Array</span>[<span class="type">String</span>] = <span class="type">Array</span>(<span class="string">&quot;LotFrontage&quot;</span>, <span class="string">&quot;LotArea&quot;</span>, <span class="string">&quot;MasVnrArea&quot;</span>, <span class="string">&quot;BsmtFinSF1&quot;</span>, <span class="string">&quot;BsmtFinSF2&quot;</span>, <span class="string">&quot;BsmtUnfSF&quot;</span>, <span class="string">&quot;TotalBsmtSF&quot;</span>, <span class="string">&quot;1stFlrSF&quot;</span>, <span class="string">&quot;2ndFlrSF&quot;</span>, <span class="string">&quot;LowQualFinSF&quot;</span>, <span class="string">&quot;GrLivArea&quot;</span>, <span class="string">&quot;BsmtFullBath&quot;</span>, <span class="string">&quot;BsmtHalfBath&quot;</span>, <span class="string">&quot;FullBath&quot;</span>, <span class="string">&quot;HalfBath&quot;</span>, <span class="string">&quot;KitchenAbvGr&quot;</span>, <span class="string">&quot;TotRmsAbvGrd&quot;</span>, <span class="string">&quot;Fireplaces&quot;</span>, <span class="string">&quot;GarageCars&quot;</span>, <span class="string">&quot;GarageArea&quot;</span>, <span class="string">&quot;WoodDeckSF&quot;</span>, <span class="string">&quot;OpenPorchSF&quot;</span>, <span class="string">&quot;EnclosedPorch&quot;</span>, <span class="string">&quot;3SsnPorch&quot;</span>, <span class="string">&quot;ScreenPorch&quot;</span>, <span class="string">&quot;PoolArea&quot;</span> )</span><br><span class="line"><span class="comment">//非数值型字段</span></span><br><span class="line"><span class="keyword">val</span> categoricalFields: <span class="type">Array</span>[<span class="type">String</span>] = <span class="type">Array</span>(<span class="string">&quot;MSSubClass&quot;</span>, <span class="string">&quot;MSZoning&quot;</span>, <span class="string">&quot;Street&quot;</span>, <span class="string">&quot;Alley&quot;</span>, <span class="string">&quot;LotShape&quot;</span>, <span class="string">&quot;LandContour&quot;</span>, <span class="string">&quot;Utilities&quot;</span>, <span class="string">&quot;LotConfig&quot;</span>, <span class="string">&quot;LandSlope&quot;</span>, <span class="string">&quot;Neighborhood&quot;</span>, <span class="string">&quot;Condition1&quot;</span>, <span class="string">&quot;Condition2&quot;</span>, <span class="string">&quot;BldgType&quot;</span>, <span class="string">&quot;HouseStyle&quot;</span>, <span class="string">&quot;YearBuilt&quot;</span>, <span class="string">&quot;YearRemodAdd&quot;</span>, <span class="string">&quot;RoofStyle&quot;</span>, <span class="string">&quot;RoofMatl&quot;</span>, <span class="string">&quot;Exterior1st&quot;</span>, <span class="string">&quot;Exterior2nd&quot;</span>, <span class="string">&quot;MasVnrType&quot;</span>, <span class="string">&quot;ExterQual&quot;</span>, <span class="string">&quot;ExterCond&quot;</span>, <span class="string">&quot;Foundation&quot;</span>, <span class="string">&quot;BsmtQual&quot;</span>, <span class="string">&quot;BsmtCond&quot;</span>, <span class="string">&quot;BsmtExposure&quot;</span>, <span class="string">&quot;BsmtFinType1&quot;</span>, <span class="string">&quot;BsmtFinType2&quot;</span>, <span class="string">&quot;Heating&quot;</span>, <span class="string">&quot;HeatingQC&quot;</span>, <span class="string">&quot;CentralAir&quot;</span>, <span class="string">&quot;Electrical&quot;</span>, <span class="string">&quot;KitchenQual&quot;</span>, <span class="string">&quot;Functional&quot;</span>, <span class="string">&quot;FireplaceQu&quot;</span>, <span class="string">&quot;GarageType&quot;</span>, <span class="string">&quot;GarageYrBlt&quot;</span>, <span class="string">&quot;GarageFinish&quot;</span>, <span class="string">&quot;GarageQual&quot;</span>, <span class="string">&quot;GarageCond&quot;</span>, <span class="string">&quot;PavedDrive&quot;</span>, <span class="string">&quot;PoolQC&quot;</span>, <span class="string">&quot;Fence&quot;</span>, <span class="string">&quot;MiscFeature&quot;</span>, <span class="string">&quot;MiscVal&quot;</span>, <span class="string">&quot;MoSold&quot;</span>, <span class="string">&quot;YrSold&quot;</span>, <span class="string">&quot;SaleType&quot;</span>, <span class="string">&quot;SaleCondition&quot;</span>)</span><br><span class="line"><span class="comment">// Label字段</span></span><br><span class="line"><span class="keyword">val</span> labelFields: <span class="type">Array</span>[<span class="type">String</span>] = <span class="type">Array</span>(<span class="string">&quot;SalePrice&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="3-预处理：StringIndexer"><a href="#3-预处理：StringIndexer" class="headerlink" title="3. 预处理：StringIndexer"></a>3. 预处理：StringIndexer</h3><blockquote>
<p>官网对StringIndexer的描述：</p>
<p>A label indexer that maps string column(s) of labels to ML column(s) of label indices. If the input columns are numeric, we cast them to string and index the string values. The indices are in [0, numLabels). By default, this is ordered by label frequencies so the most frequent label gets index 0. The ordering behavior is controlled by setting stringOrderType.</p>
</blockquote>
<p>简单来说就是以数据列为单位，把字段中的字符串转换为数值索引。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//把数值型字段从字符串转化为数字</span></span><br><span class="line"><span class="keyword">for</span> (field &lt;- (numericFields ++ labelFields ++ discreteFields)) &#123;</span><br><span class="line">  df = df</span><br><span class="line">    .withColumn(<span class="string">s&quot;<span class="subst">$&#123;field&#125;</span>Int&quot;</span>,col(field).cast(<span class="type">IntegerType</span>))</span><br><span class="line">    .drop(field)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 用StringIndexer把非数值字段转化为数值字段</span></span><br><span class="line"><span class="keyword">val</span> indexFields: <span class="type">Array</span>[<span class="type">String</span>] = categoricalFields.map(_ + <span class="string">&quot;Index&quot;</span>)</span><br><span class="line"><span class="comment">// 定义StringIndexer实例</span></span><br><span class="line"><span class="keyword">val</span> stringIndexer = <span class="keyword">new</span> <span class="type">StringIndexer</span>()</span><br><span class="line">  .setInputCols(categoricalFields)</span><br><span class="line">  .setOutputCols(indexFields)</span><br><span class="line">  .setHandleInvalid(<span class="string">&quot;keep&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="4-离散化：Bucketizer"><a href="#4-离散化：Bucketizer" class="headerlink" title="4. 离散化：Bucketizer"></a>4. 离散化：Bucketizer</h3><p>离散化的目的：</p>
<p>​	对于BedroomAbvGr这个字段，它的含义是居室数量，在 train.csv 这份数据样本中，“BedroomAbvGr”包含从 1 到 8 的连续整数。我们可以将1，2分为小户型，3，4分为中户型，5，6，7，8分为大户型，这样离散化后，数据的多样性从原来的8降低为3。离散化的动机，主要在于提升特征数据的区分度与内聚性，从而与预测标的产生更强的关联。</p>
<blockquote>
<p>官网对Bucketizer的描述：</p>
<p>Bucketizer maps a column of continuous features to a column of feature buckets.</p>
<p>Since 2.3.0, Bucketizer can map multiple columns at once by setting the inputCols parameter. Note that when both the inputCol and inputCols parameters are set, an Exception will be thrown. The splits parameter is only used for single column usage, and splitsArray is for multiple columns.</p>
</blockquote>
<p>简单来说就是将连续特征映射为特征桶（feature buckets）</p>
<p>我选取了三个特征做离散化操作，以下是这三个特征的描述：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">OverallQual</span>: <span class="type">Rates</span> the overall material and finish of the house</span><br><span class="line">       <span class="number">10</span>	<span class="type">Very</span> <span class="type">Excellent</span></span><br><span class="line">       <span class="number">9</span>	<span class="type">Excellent</span></span><br><span class="line">       <span class="number">8</span>	<span class="type">Very</span> <span class="type">Good</span></span><br><span class="line">       <span class="number">7</span>	<span class="type">Good</span></span><br><span class="line">       <span class="number">6</span>	<span class="type">Above</span> <span class="type">Average</span></span><br><span class="line">       <span class="number">5</span>	<span class="type">Average</span></span><br><span class="line">       <span class="number">4</span>	<span class="type">Below</span> <span class="type">Average</span></span><br><span class="line">       <span class="number">3</span>	<span class="type">Fair</span></span><br><span class="line">       <span class="number">2</span>	<span class="type">Poor</span></span><br><span class="line">       <span class="number">1</span>	<span class="type">Very</span> <span class="type">Poor</span>	</span><br><span class="line"><span class="type">OverallCond</span>: <span class="type">Rates</span> the overall condition of the house</span><br><span class="line">       <span class="number">10</span>	<span class="type">Very</span> <span class="type">Excellent</span></span><br><span class="line">       <span class="number">9</span>	<span class="type">Excellent</span></span><br><span class="line">       <span class="number">8</span>	<span class="type">Very</span> <span class="type">Good</span></span><br><span class="line">       <span class="number">7</span>	<span class="type">Good</span></span><br><span class="line">       <span class="number">6</span>	<span class="type">Above</span> <span class="type">Average</span>	</span><br><span class="line">       <span class="number">5</span>	<span class="type">Average</span></span><br><span class="line">       <span class="number">4</span>	<span class="type">Below</span> <span class="type">Average</span>	</span><br><span class="line">       <span class="number">3</span>	<span class="type">Fair</span></span><br><span class="line">       <span class="number">2</span>	<span class="type">Poor</span></span><br><span class="line">       <span class="number">1</span>	<span class="type">Very</span> <span class="type">Poor</span></span><br><span class="line"><span class="type">BedroomAbvGr</span>: <span class="type">Number</span> of bedrooms</span><br></pre></td></tr></table></figure>

<p>对于前两个特征OverallQual和OverallCond，我将它们从3和7的位置分隔为3个等级</p>
<p>第三个特征BedroomAbvGr在数据集中的值域是[1,8]，我将它从3和5的位置分为3个等级</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//离散化</span></span><br><span class="line"><span class="keyword">val</span> discrete = discreteFields.map(_ + <span class="string">&quot;Discrete&quot;</span>)</span><br><span class="line">discreteFields = discreteFields.map(_ + <span class="string">&quot;Int&quot;</span>)</span><br><span class="line"><span class="keyword">val</span> bedroomAbvGrSplits: <span class="type">Array</span>[<span class="type">Double</span>] = <span class="type">Array</span>(<span class="type">Double</span>.<span class="type">NegativeInfinity</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="type">Double</span>.<span class="type">PositiveInfinity</span>)</span><br><span class="line"><span class="keyword">val</span> <span class="type">OverallQualSplits</span>: <span class="type">Array</span>[<span class="type">Double</span>] = <span class="type">Array</span>(<span class="type">Double</span>.<span class="type">NegativeInfinity</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="type">Double</span>.<span class="type">PositiveInfinity</span>)</span><br><span class="line"><span class="keyword">val</span> <span class="type">OverallCondSplits</span>: <span class="type">Array</span>[<span class="type">Double</span>] = <span class="type">Array</span>(<span class="type">Double</span>.<span class="type">NegativeInfinity</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="type">Double</span>.<span class="type">PositiveInfinity</span>)</span><br><span class="line"><span class="comment">// 定义并初始化Bucketizer</span></span><br><span class="line"><span class="keyword">val</span> bucketizer = <span class="keyword">new</span> <span class="type">Bucketizer</span>()</span><br><span class="line">  <span class="comment">// 指定原始列</span></span><br><span class="line">  .setInputCols(discreteFields)</span><br><span class="line">  <span class="comment">// 指定目标列</span></span><br><span class="line">  .setOutputCols(discrete)</span><br><span class="line">  <span class="comment">// 指定离散区间</span></span><br><span class="line">  .setSplitsArray(<span class="type">Array</span>(<span class="type">OverallQualSplits</span>,<span class="type">OverallCondSplits</span>, bedroomAbvGrSplits))</span><br></pre></td></tr></table></figure>

<h3 id="5-Embedding：OneHotEncoder"><a href="#5-Embedding：OneHotEncoder" class="headerlink" title="5. Embedding：OneHotEncoder"></a>5. Embedding：OneHotEncoder</h3><p>对于字段值不存在大小关系的字段来说，只是将其转化为数值型字段是没有意义的，这就要用到Embedding（向量化）了</p>
<blockquote>
<p>官网对OneHotEncoder的描述：</p>
<p>A one-hot encoder that maps a column of category indices to a column of binary vectors, with at most a single one-value per row that indicates the input category index. For example with 5 categories, an input value of 2.0 would map to an output vector of [0.0, 0.0, 1.0, 0.0]. The last category is not included by default (configurable via dropLast), because it makes the vector entries sum up to one, and hence linearly dependent. So an input value of 4.0 maps to [0.0, 0.0, 0.0, 0.0].</p>
</blockquote>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//独热编码</span></span><br><span class="line"><span class="comment">//对所有非数值字段</span></span><br><span class="line"><span class="keyword">val</span> oheFields: <span class="type">Array</span>[<span class="type">String</span>] = categoricalFields.map(_ + <span class="string">&quot;OHE&quot;</span>)</span><br><span class="line"><span class="keyword">val</span> oneHotEncoder = <span class="keyword">new</span> <span class="type">OneHotEncoder</span>()</span><br><span class="line">  .setInputCols(indexFields)</span><br><span class="line">  .setOutputCols(oheFields)</span><br></pre></td></tr></table></figure>

<h3 id="6-归一化：MinMaxScaler"><a href="#6-归一化：MinMaxScaler" class="headerlink" title="6. 归一化：MinMaxScaler"></a>6. 归一化：MinMaxScaler</h3><p>归一化（Normalization）的作用，是把一组数值，统一映射到同一个值域，而这个值域通常是[0, 1]。当原始数据之间的量纲差异较大时，在模型训练的过程中，梯度下降不稳定、抖动较大，模型不容易收敛，从而导致训练效率较差。相反，当所有特征数据都被约束到同一个值域时，模型训练的效率会得到大幅提升。</p>
<blockquote>
<p>官网对OneHotEncoder的描述：</p>
<p>Rescale each feature individually to a common range [min, max] linearly using column summary statistics, which is also known as min-max normalization or Rescaling. The rescaled value for feature E is calculated as:</p>
<p><img src="https://static001.geekbang.org/resource/image/2c/2e/2c934e54729931bdf18288c93040a42e.png?wh=744x104"></p>
</blockquote>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 构建特征向量</span></span><br><span class="line"><span class="keyword">val</span> numericFeatures: <span class="type">Array</span>[<span class="type">String</span>] = numericFields.map(_ + <span class="string">&quot;Int&quot;</span>)</span><br><span class="line"><span class="keyword">val</span> vectorAssembler = <span class="keyword">new</span> <span class="type">VectorAssembler</span>()</span><br><span class="line">  .setInputCols(numericFeatures ++ indexFields ++ discrete)</span><br><span class="line">  .setOutputCol(<span class="string">&quot;features&quot;</span>)</span><br><span class="line">  .setHandleInvalid(<span class="string">&quot;keep&quot;</span>)</span><br><span class="line"><span class="comment">//归一化</span></span><br><span class="line"><span class="keyword">val</span> minMaxScaler = <span class="keyword">new</span> <span class="type">MinMaxScaler</span>()</span><br><span class="line">  .setInputCol(<span class="string">&quot;features&quot;</span>)</span><br><span class="line">  .setOutputCol(<span class="string">&quot;vector&quot;</span>)</span><br><span class="line"><span class="keyword">val</span> vectorIndexer = <span class="keyword">new</span> <span class="type">VectorIndexer</span>()</span><br><span class="line">  .setInputCol(<span class="string">&quot;vector&quot;</span>)</span><br><span class="line">  .setOutputCol(<span class="string">&quot;indexedFeatures&quot;</span>)</span><br><span class="line">  <span class="comment">// 指定连续、离散判定阈值</span></span><br><span class="line">  .setMaxCategories(<span class="number">30</span>)</span><br><span class="line">  .setHandleInvalid(<span class="string">&quot;keep&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="决策树模型"><a href="#决策树模型" class="headerlink" title="决策树模型"></a>决策树模型</h2><p>用不同特征的不同取值的组合，将数据集分为若干类</p>
<blockquote>
<p>维基百科对决策树的描述：</p>
<p>Gradient boosting is a machine learning technique used in regression and classification tasks, among others. It gives a prediction model in the form of an ensemble of weak prediction models, which are typically decision trees. When a decision tree is the weak learner, the resulting algorithm is called gradient-boosted trees; it usually outperforms random forest.A gradient-boosted trees model is built in a stage-wise fashion as in other boosting methods, but it generalizes the other methods by allowing optimization of an arbitrary differentiable loss function.</p>
</blockquote>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> gbtRegressor = <span class="keyword">new</span> <span class="type">GBTRegressor</span>()</span><br><span class="line">  <span class="comment">// 指定预测标的</span></span><br><span class="line">  .setLabelCol(<span class="string">&quot;SalePriceInt&quot;</span>)</span><br><span class="line">  <span class="comment">// 指定特征向量</span></span><br><span class="line">  .setFeaturesCol(<span class="string">&quot;indexedFeatures&quot;</span>)</span><br><span class="line">  <span class="comment">// 指定决策树的数量</span></span><br><span class="line">  .setMaxIter(<span class="number">30</span>)</span><br><span class="line">  <span class="comment">// 指定决策树的最大深度</span></span><br><span class="line">  .setMaxDepth(<span class="number">5</span>)</span><br><span class="line">  .setMaxBins(<span class="number">113</span>)</span><br></pre></td></tr></table></figure>

<h2 id="模型训练与测试"><a href="#模型训练与测试" class="headerlink" title="模型训练与测试"></a>模型训练与测试</h2><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//将所有步骤拼接起来</span></span><br><span class="line"><span class="keyword">val</span> components = <span class="type">Array</span>(stringIndexer, bucketizer, oneHotEncoder, vectorAssembler, minMaxScaler, vectorIndexer, gbtRegressor)</span><br><span class="line"><span class="keyword">val</span> pipeline = <span class="keyword">new</span> <span class="type">Pipeline</span>().setStages(components)</span><br><span class="line"><span class="comment">// 划分出训练集和验证集</span></span><br><span class="line"><span class="keyword">val</span> <span class="type">Array</span>(trainingData, validationData) = df.randomSplit(<span class="type">Array</span>(<span class="number">0.7</span>, <span class="number">0.3</span>))</span><br><span class="line"><span class="comment">// 调用fit方法，触发Pipeline计算，并最终拟合出模型</span></span><br><span class="line"><span class="keyword">val</span> pipelineModel = pipeline.fit(trainingData)</span><br><span class="line"></span><br><span class="line"><span class="comment">//测试</span></span><br><span class="line"><span class="keyword">val</span> predictions: <span class="type">DataFrame</span> = pipelineModel.transform(validationData).select(<span class="string">&quot;SalePriceInt&quot;</span>, <span class="string">&quot;prediction&quot;</span>)</span><br><span class="line">predictions.show</span><br><span class="line"><span class="keyword">val</span> evaluator = <span class="keyword">new</span> <span class="type">RegressionEvaluator</span>().setLabelCol(<span class="string">&quot;SalePriceInt&quot;</span>).setPredictionCol(<span class="string">&quot;prediction&quot;</span>).setMetricName(<span class="string">&quot;rmse&quot;</span>)</span><br><span class="line"><span class="keyword">val</span> rmse = evaluator.evaluate(predictions)</span><br><span class="line">println(<span class="string">&quot;Root Mean Squared Error (RMSE) on test data = &quot;</span> + rmse)</span><br><span class="line"></span><br><span class="line"><span class="comment">//输出</span></span><br><span class="line">+------------+------------------+</span><br><span class="line">|<span class="type">SalePriceInt</span>|        prediction|</span><br><span class="line">+------------+------------------+</span><br><span class="line">|      <span class="number">208500</span>| <span class="number">194936.7390633201</span>|</span><br><span class="line">|      <span class="number">118000</span>| <span class="number">119025.8916425119</span>|</span><br><span class="line">|       <span class="number">82000</span>| <span class="number">61752.41121907966</span>|</span><br><span class="line">|       <span class="number">86000</span>| <span class="number">66919.40597545142</span>|</span><br><span class="line">|      <span class="number">232000</span>|<span class="number">247479.64950853962</span>|</span><br><span class="line">|      <span class="number">205000</span>|<span class="number">185552.29830149628</span>|</span><br><span class="line">|      <span class="number">102000</span>|<span class="number">127362.53595460855</span>|</span><br><span class="line">|      <span class="number">227000</span>|<span class="number">208367.37768488855</span>|</span><br><span class="line">|      <span class="number">203000</span>|  <span class="number">238802.515083912</span>|</span><br><span class="line">|      <span class="number">178000</span>| <span class="number">166284.1585451415</span>|</span><br><span class="line">|      <span class="number">191000</span>|<span class="number">190125.10112212482</span>|</span><br><span class="line">|      <span class="number">287000</span>| <span class="number">423247.5498783909</span>|</span><br><span class="line">|      <span class="number">112500</span>|<span class="number">128910.00291716766</span>|</span><br><span class="line">|      <span class="number">293077</span>|<span class="number">240677.67824324753</span>|</span><br><span class="line">|       <span class="number">84000</span>|  <span class="number">61818.4933553084</span>|</span><br><span class="line">|      <span class="number">315500</span>| <span class="number">263464.3610693604</span>|</span><br><span class="line">|       <span class="number">80000</span>| <span class="number">78665.99046630661</span>|</span><br><span class="line">|      <span class="number">262280</span>| <span class="number">302944.9443747723</span>|</span><br><span class="line">|      <span class="number">139600</span>|<span class="number">175819.03135313356</span>|</span><br><span class="line">|      <span class="number">169500</span>|<span class="number">205292.33446646377</span>|</span><br><span class="line">+------------+------------------+</span><br><span class="line">only showing top <span class="number">20</span> rows</span><br><span class="line"><span class="type">Root</span> <span class="type">Mean</span> <span class="type">Squared</span> <span class="type">Error</span> (<span class="type">RMSE</span>) on test data = <span class="number">36637.90806077914</span></span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://example.com">62bit</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2022/12/07/Kaggle%E7%BB%83%E4%B9%A0-Spark%E6%88%BF%E4%BB%B7%E9%A2%84%E6%B5%8B/">http://example.com/2022/12/07/Kaggle%E7%BB%83%E4%B9%A0-Spark%E6%88%BF%E4%BB%B7%E9%A2%84%E6%B5%8B/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">62bit的秘密基地</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/favicon.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/01/27/ElasticSearch%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="ElasticSearch学习笔记"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">ElasticSearch学习笔记</div></div></a></div><div class="next-post pull-right"><a href="/2022/11/21/Spark%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="Spark学习笔记"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Spark学习笔记</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/favicon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">62bit</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">31</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/62bit"><i class="fab fa-github"></i><span>My Github</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">江苏科技大学某不知名菜鸟的个人博客
喜欢术力口和跳舞的准程序猿</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%86%99%E5%9C%A8%E5%89%8D%E9%9D%A2"><span class="toc-number">1.</span> <span class="toc-text">写在前面</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%B7%E4%BD%93%E5%AE%9E%E7%8E%B0"><span class="toc-number">2.</span> <span class="toc-text">具体实现</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E5%BE%81%E5%B7%A5%E7%A8%8B"><span class="toc-number">2.1.</span> <span class="toc-text">特征工程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE"><span class="toc-number">2.1.1.</span> <span class="toc-text">1. 读取数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%95%B0%E6%8D%AE%E5%88%86%E7%B1%BB"><span class="toc-number">2.1.2.</span> <span class="toc-text">2. 数据分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E9%A2%84%E5%A4%84%E7%90%86%EF%BC%9AStringIndexer"><span class="toc-number">2.1.3.</span> <span class="toc-text">3. 预处理：StringIndexer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E7%A6%BB%E6%95%A3%E5%8C%96%EF%BC%9ABucketizer"><span class="toc-number">2.1.4.</span> <span class="toc-text">4. 离散化：Bucketizer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-Embedding%EF%BC%9AOneHotEncoder"><span class="toc-number">2.1.5.</span> <span class="toc-text">5. Embedding：OneHotEncoder</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E5%BD%92%E4%B8%80%E5%8C%96%EF%BC%9AMinMaxScaler"><span class="toc-number">2.1.6.</span> <span class="toc-text">6. 归一化：MinMaxScaler</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%B3%E7%AD%96%E6%A0%91%E6%A8%A1%E5%9E%8B"><span class="toc-number">2.2.</span> <span class="toc-text">决策树模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B%E8%AE%AD%E7%BB%83%E4%B8%8E%E6%B5%8B%E8%AF%95"><span class="toc-number">2.3.</span> <span class="toc-text">模型训练与测试</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/09/08/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E6%80%9D%E7%BB%B4%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="数据分析思维学习笔记">数据分析思维学习笔记</a><time datetime="2023-09-08T01:39:32.000Z" title="发表于 2023-09-08 09:39:32">2023-09-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/03/20/%E9%9D%A2%E8%AF%95%E4%B8%AD%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%B8%AAJava%E5%9F%BA%E7%A1%80%E9%97%AE%E9%A2%98/" title="面试中遇到的一个Java基础问题">面试中遇到的一个Java基础问题</a><time datetime="2023-03-20T09:30:50.000Z" title="发表于 2023-03-20 17:30:50">2023-03-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/03/19/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%E4%B9%8BADS%E5%B1%82%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/" title="数据仓库之ADS层数据可视化">数据仓库之ADS层数据可视化</a><time datetime="2023-03-19T07:36:31.000Z" title="发表于 2023-03-19 15:36:31">2023-03-19</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/03/16/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%E4%B9%8B%E7%BB%B4%E5%BA%A6%E5%BB%BA%E6%A8%A1/" title="数据仓库之维度建模">数据仓库之维度建模</a><time datetime="2023-03-16T10:26:18.000Z" title="发表于 2023-03-16 18:26:18">2023-03-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/03/12/%E7%AE%97%E6%B3%95%E5%A4%8D%E4%B9%A0%E4%B9%8B%E4%BA%8C%E5%8F%89%E6%A0%91/" title="数据结构与算法复习之二叉树">数据结构与算法复习之二叉树</a><time datetime="2023-03-12T10:07:12.000Z" title="发表于 2023-03-12 18:07:12">2023-03-12</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By 62bit</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">谢谢你能够看到我!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="富强,民主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>